import{r as u,R as m,j as s}from"./app-42h3fpBr.js";import{useInternalRouting as S,InternalLink as j}from"./InternalRouter-JyAOPvGR.js";import{p as d,N as L}from"./NewBrunswickMap-DT8GIKof.js";function x({title:h,titleId:r,...l},c){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},l),h?u.createElement("title",{id:r},h):null,u.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z",clipRule:"evenodd"}))}const T=u.forwardRef(x);function M({title:h,titleId:r,...l},c){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},l),h?u.createElement("title",{id:r},h):null,u.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const C=u.forwardRef(M),N=(h=300,r=10)=>{const[l,c]=m.useState(null),a=m.useRef(l);m.useEffect(()=>{a.current=l},[l]);const[f,i]=m.useState(null),e=m.useRef(f);return m.useEffect(()=>{e.current=f},[f]),{onTouchStart:n=>o=>{const t=o.touches[0];c({time:Date.now(),x:t.clientX,y:t.clientY}),i({x:t.clientX,y:t.clientY}),console.log("start")},onTouchMove:n=>o=>{const t=o.touches[0];i({x:t.clientX,y:t.clientY}),console.log("move")},onTouchEnd:n=>o=>{console.log({callback:n});const t=a.current,p=e.current;if(console.log("end"),t){const b=Date.now()-t.time,w=Math.abs(t.x-p.x),E=Math.abs(t.y-p.y);b<=h&&w<=r&&E<=r&&n(o)}c(null),i(null)}}};function P({containerRef:h=null,onTouchLocation:r}){const l=h||m.createRef(null),c=N();return m.useEffect(()=>{if(l.current){const a=l.current.querySelector("svg");Object.keys(d).forEach(f=>{const i=a.querySelector("#"+f);i.classList.add("location"),r&&(i.addEventListener("touchstart",c.onTouchStart(()=>null)),i.addEventListener("touchmove",c.onTouchMove(()=>null)),i.addEventListener("touchend",c.onTouchEnd(e=>{Object.keys(d).forEach(v=>{a.querySelector("#"+v).classList.remove("active")}),a.querySelector("#"+f).classList.add("active"),r(e,f)})))})}},[l.current]),s.jsx(L,{containerRef:l})}function B({locations:h}){const r=S(),l=u.useRef(null),c=u.useRef(null),[a,f]=u.useState(null),i=u.useRef(a);u.useEffect(()=>{i.current=a},[a]);const e=h.reduce((n,o)=>(n[o.name]=o,n),{}),v=n=>{const o=d[n];return e[o]};function g(n){R(null,"")}const R=(n,o)=>{if((i==null?void 0:i.current)===o){const t=v(o);r.setView("location",{id:t.id,breadCrumb:{position:1,label:t.name}}),r.updateBreadCrumb(1,{name:"location",params:{id:t.id},content:t.name})}c.current.querySelectorAll(".highlighted").forEach(t=>t.classList.remove("highlighted")),o?(c.current.classList.add("selected"),c.current.querySelector(`[data-path-id=${o}]`).classList.add("highlighted"),f(o)):(c.current.classList.remove("selected"),f(null))};return s.jsx("div",{className:`MapMobile portrait ${a?"selected-location":""}`,children:s.jsxs("div",{className:"container",children:[s.jsx(P,{containerRef:l,onTouchLocation:R}),s.jsxs("div",{className:"locations",ref:c,children:[s.jsx("button",{className:"close",onClick:g,children:s.jsx(C,{})}),s.jsx("ul",{children:Object.keys(d).map(n=>{var o,t;return s.jsx("li",{"data-path-id":n,children:s.jsxs(j,{name:"location",onClick:p=>{var b;if(!((b=e==null?void 0:e[d[n]])!=null&&b.hasData))return p.preventDefault(),!1},params:{id:v(n).id},breadCrumb:{position:1,label:e==null?void 0:e[d[n]].name},children:[s.jsx("h3",{children:d[n]}),s.jsxs("em",{children:[!((o=e==null?void 0:e[d[n]])!=null&&o.hasData)&&s.jsx("strong",{children:"(no data)"}),(t=e==null?void 0:e[d[n]])==null?void 0:t.description]})]})},n)})}),a&&s.jsx(j,{className:"go",name:"location",params:{id:v(a).id},breadCrumb:{position:1,label:e==null?void 0:e[d[a]].name},children:e!=null&&e[d[a]].hasData?s.jsx(T,{}):null})]})]})})}export{B as default};
