import{r as i,R as f,j as r}from"./app-Bbfg38oN.js";import{useInternalRouting as E,InternalLink as g}from"./InternalRouter-D1HVLxiQ.js";import{p as m,N as S}from"./NewBrunswickMap-5stB9KFg.js";function L({title:u,titleId:s,...l},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},l),u?i.createElement("title",{id:s},u):null,i.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z",clipRule:"evenodd"}))}const T=i.forwardRef(L);function M({title:u,titleId:s,...l},n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},l),u?i.createElement("title",{id:s},u):null,i.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const P=i.forwardRef(M),y=(u=300,s=10)=>{const[l,n]=f.useState(null),a=f.useRef(l);f.useEffect(()=>{a.current=l},[l]);const[h,d]=f.useState(null),c=f.useRef(h);return f.useEffect(()=>{c.current=h},[h]),{onTouchStart:o=>t=>{const e=t.touches[0];n({time:Date.now(),x:e.clientX,y:e.clientY}),d({x:e.clientX,y:e.clientY}),console.log("start")},onTouchMove:o=>t=>{const e=t.touches[0];d({x:e.clientX,y:e.clientY}),console.log("move")},onTouchEnd:o=>t=>{console.log({callback:o});const e=a.current,b=c.current;if(console.log("end"),e){const w=Date.now()-e.time,j=Math.abs(e.x-b.x),x=Math.abs(e.y-b.y);w<=u&&j<=s&&x<=s&&o(t)}n(null),d(null)}}};function C({containerRef:u=null,onTouchLocation:s}){const l=u||f.createRef(null),n=y();return f.useEffect(()=>{if(l.current){const a=l.current.querySelector("svg");Object.keys(m).forEach(h=>{const d=a.querySelector("#"+h);d.classList.add("location"),s&&(d.addEventListener("touchstart",n.onTouchStart(()=>null)),d.addEventListener("touchmove",n.onTouchMove(()=>null)),d.addEventListener("touchend",n.onTouchEnd(c=>{Object.keys(m).forEach(v=>{a.querySelector("#"+v).classList.remove("active")}),a.querySelector("#"+h).classList.add("active"),s(c,h)})))})}},[l.current]),r.jsx(S,{containerRef:l})}function O({locations:u}){const s=E(),l=i.useRef(null),n=i.useRef(null),[a,h]=i.useState(null),d=i.useRef(a);i.useEffect(()=>{d.current=a},[a]);const c=u.reduce((o,t)=>(o[t.name]=t,o),{}),v=o=>{const t=m[o];return c[t]};function p(o){R(null,"")}const R=(o,t)=>{if(d.current===t){const e=v(t);s.setView("location",{id:e.id,breadCrumb:{position:1,label:e.name}}),s.updateBreadCrumb(1,{name:"location",params:{id:e.id},content:e.name})}n.current.querySelectorAll(".highlighted").forEach(e=>e.classList.remove("highlighted")),t?(n.current.classList.add("selected"),n.current.querySelector(`[data-path-id=${t}]`).classList.add("highlighted"),h(t)):(n.current.classList.remove("selected"),h(null))};return r.jsx("div",{className:`MapMobile portrait ${a?"selected-location":""}`,children:r.jsxs("div",{className:"container",children:[r.jsx(C,{containerRef:l,onTouchLocation:R}),r.jsxs("div",{className:"locations",ref:n,children:[r.jsx("button",{className:"close",onClick:p,children:r.jsx(P,{})}),r.jsx("ul",{children:Object.keys(m).map(o=>{var t;return r.jsx("li",{"data-path-id":o,children:r.jsxs(g,{name:"location",params:{id:v(o).id},breadCrumb:{position:1,label:c==null?void 0:c[m[o]].name},children:[r.jsx("h3",{children:m[o]}),r.jsx("em",{children:(t=c==null?void 0:c[m[o]])==null?void 0:t.description})]})},o)})}),a&&r.jsx(g,{className:"go",name:"location",params:{id:v(a).id},breadCrumb:{position:1,label:c==null?void 0:c[m[a]].name},children:r.jsx(T,{})})]})]})})}export{O as default};
