import{r as u,j as n}from"./app-C7CMKy6u.js";import{p as v}from"./parseMySqlDate-C9Y-iq6S.js";import{t as p,L as B,f as m,c as j}from"./format-CI9Xab1_.js";import{useInternalRouting as C}from"./InternalRouter-oosjEhN5.js";import{T as W}from"./Tooltip-DCrgq9Go.js";import"./HomeIcon-B_Be1uDW.js";/* empty css                */function M(r,s){const a=+p(r)-+p(s);return a<0?-1:a>0?1:a}function D(r,s){return+p(r)<+p(s)}function R(r,s){return+p(r)==+p(s)}function A({title:r,titleId:s,...a},d){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":s},a),r?u.createElement("title",{id:s},r):null,u.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z",clipRule:"evenodd"}))}const O=u.forwardRef(A);function Z({title:r,titleId:s,...a},d){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:d,"aria-labelledby":s},a),r?u.createElement("title",{id:s},r):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const q=u.forwardRef(Z);function I(r){var s;return{seasonStart:v(r.season_start),seasonEnd:v(r.season_end),bagLimit:r.bag_limit,minSize:r.minimum_size,maxSize:r.maximum_size,fishingMethod:J(r),tidal:P(r),water:((s=r==null?void 0:r.water)==null?void 0:s.name)??"",waterDescription:r.water_description??""}}function J(r){var a,d;let s="";return((a=r==null?void 0:r.fishing_method)==null?void 0:a.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?s="Fly Fishing":s=((d=r==null?void 0:r.fishing_method)==null?void 0:d.name)??"",s}function P(r){let s="";return r.tidal_category&&(s&&(s+=" in "),s+=r.tidal_category.name+" waters"),s}function H(r){if(!r.length)return;const s=r.reduce((a,d)=>{var t;const f=((t=d==null?void 0:d.fish)==null?void 0:t.name)??null;if(!a[f]){const o={seasonStart:null,seasonEnd:null,limits:[]};a[f]=o}return a[f].limits.push(I(d)),a},{});return Object.keys(s).forEach(a=>{s[a].limits=s[a].limits.reduce((t,o)=>{let c=0,x=!1;for(;!x&&c<t.length;)!t[c].waterDescription&&R(o.seasonStart,t[c].seasonStart)&&R(o.seasonEnd,t[c].seasonEnd)&&o.bagLimit===t[c].bagLimit&&o.minimumSize===t[c].minimumSize&&o.maximumSize===t[c].maximumSize&&(x=!0,o.fishingMethod!==t[c].fishingMethod&&(t[c].fishingMethod=""),o.tidal!==t[c].tidal&&(t[c].tidal="")),c++;return x||t.push(o),t},[]),s[a].limits=s[a].limits.sort((t,o)=>{const c=M(t.seasonStart,o.seasonStart);return c===0?o.fishingMethod||o.tidal||o.waterDescription?-1:M(o.seasonEnd,t.seasonEnd):c}),s[a].limits.forEach(t=>{t.bagLimit&&(s[a].seasonStart?D(t.seasonStart,s[a].seasonStart)&&(s[a].seasonStart=t.seasonStart):s[a].seasonStart=t.seasonStart,s[a].seasonEnd&&D(t.seasonEnd,s[a].seasonEnd)||(s[a].seasonEnd=t.seasonEnd))});const d={};let f=0;for(;f<s[a].limits.length;){const t=s[a].limits[f],o=[t.fishingMethod,t.tidal,t.waterDescription].join("-");t.waterDescription&&d[o]?(d[o].group||(d[o].group=[]),d[o].group.push(t),s[a].limits.splice(f,1)):(d[o]=t,f++)}}),s}function ee({children:r,id:s,route:a,...d}){const f=u.useRef(null),[t,o]=u.useState([]),[c,x]=u.useState({}),[F,S]=u.useState(!1),z=C();u.useEffect(()=>{z.setLoading(!1)},[]),u.useEffect(()=>{S(!0),axios.get(a(s,"")).then(e=>{o(e.data.limits??[])}).finally(()=>S(!1))},[]),u.useEffect(()=>{x(H(t))},[t]);const[h,_]=u.useState({}),k=e=>{if(console.log(e),e.defaultPrevented)return;const i=e.currentTarget.value;_(l=>{const g=JSON.parse(JSON.stringify(l));return g[i]=!(g!=null&&g[i]),g})},w=(e,i=!1)=>(console.log(m(e.seasonStart,j.displayDayMonthShortFormat)),n.jsxs(n.Fragment,{children:[n.jsxs("span",{children:[m(e.seasonStart,j.displayDayMonthShortFormat)," "]}),n.jsxs("span",{children:["- ",m(e.seasonEnd,j.displayDayMonthShortFormat),i?",":""]})]})),E=e=>e.waterDescription?n.jsx("em",{className:"water-description",children:y(e,!1)}):null,y=(e,i=!0)=>{if(i&&e.waterDescription)return"";let l=e.fishingMethod;return e.tidal&&(l&&(l+=" in "),l+=e.tidal),l||(l+=e.water),l+=" "+e.waterDescription,l},N=e=>{const i=(e==null?void 0:e.minSize)??"N/A";return e.bagLimit===0?n.jsx("span",{className:"invalid",children:i}):i},$=e=>{const i=(e==null?void 0:e.maxSize)??"N/A";return e.bagLimit===0?n.jsx("span",{className:"invalid",children:i}):i},T=e=>e.bagLimit===null?n.jsx("span",{className:"text-md leading-4",children:"∞"}):e.bagLimit,b=(e,i=!1)=>n.jsxs("div",{className:`limit ${i?"group":""} ${e.group?"group-start":""}`,children:[n.jsxs("div",{className:"season-exception",children:[n.jsx("span",{className:"date-span",children:w(e,e.group||i)}),n.jsxs("em",{className:"exception",children:[" ",y(e)]})]}),n.jsx("div",{children:T(e)}),n.jsx("div",{children:N(e)}),n.jsx("div",{children:$(e)})]}),L=(e,i=!1)=>e.map((l,g)=>l!=null&&l.group?n.jsxs(n.Fragment,{children:[b(l),L(l.group,!0),E(l)]}):n.jsxs(n.Fragment,{children:[b(l,i),i?null:E(l)]}));return n.jsx("div",{className:"Water",children:n.jsxs("div",{className:"fish-grid",ref:f,children:[n.jsxs("div",{className:"header",children:[n.jsx("div",{className:"column-header date-range",children:"Season/Restrictions"}),n.jsx("div",{className:"column-header",children:"Bag Limit"}),n.jsx("div",{className:"column-header",children:"Min. Size"}),n.jsx("div",{className:"column-header",children:"Max. Size"})]}),n.jsx("div",{className:"body",children:F?n.jsx("div",{className:"loading-spinner-container",children:n.jsx(B,{})}):Object.keys(c??{}).map((e,i)=>n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:k,value:e,className:`fish-name ${i%2===0?"even":"odd"} ${h!=null&&h[e]?"open":""}`,children:[n.jsxs("div",{className:"fish-season",children:[n.jsxs("strong",{children:[n.jsx(O,{className:"open-indicator"}),e]}),n.jsxs("em",{children:["(",w(c[e]),")"]})]}),n.jsx("div",{className:"flex",children:c[e].limits.length>1?n.jsx(W,{message:"Some Restrictions",containerRef:f,children:n.jsx(q,{className:"alert"})}):null})]}),n.jsx("div",{className:`limits ${i%2===0?"even":"odd"} ${h!=null&&h[e]?"open":""}`,children:L(c[e].limits)})]}))})]})})}export{ee as default};
