import{r as u,R as m,j as n}from"./app-CpkJJ9s6.js";import{p as M}from"./parseMySqlDate-B5Sr_pD9.js";import{t as p,L as T,f as j,c as S}from"./format-R2ps2Vo5.js";import{useInternalRouting as C}from"./InternalRouter-C3n-VHum.js";import{T as W}from"./Tooltip-D0G4TxKS.js";import"./HomeIcon-VE8V8Egm.js";/* empty css                */function D(r,s){const a=+p(r)-+p(s);return a<0?-1:a>0?1:a}function F(r,s){return+p(r)<+p(s)}function R(r,s){return+p(r)==+p(s)}function A({title:r,titleId:s,...a},i){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":s},a),r?u.createElement("title",{id:s},r):null,u.createElement("path",{fillRule:"evenodd",d:"M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z",clipRule:"evenodd"}))}const O=u.forwardRef(A);function Z({title:r,titleId:s,...a},i){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":s},a),r?u.createElement("title",{id:s},r):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const q=u.forwardRef(Z);function I(r){var s;return{seasonStart:M(r.season_start),seasonEnd:M(r.season_end),bagLimit:r.bag_limit,minSize:r.minimum_size,maxSize:r.maximum_size,fishingMethod:J(r),tidal:P(r),water:((s=r==null?void 0:r.water)==null?void 0:s.name)??"",waterDescription:r.water_description??""}}function J(r){var a,i;let s="";return((a=r==null?void 0:r.fishing_method)==null?void 0:a.name)==="May only be angled by artificial fly or baited barbless hook with a single point"?s="Fly Fishing":s=((i=r==null?void 0:r.fishing_method)==null?void 0:i.name)??"",s}function P(r){let s="";return r.tidal_category&&(s&&(s+=" in "),s+=r.tidal_category.name+" waters"),s}function H(r){if(!r.length)return;const s=r.reduce((a,i)=>{var t;const f=((t=i==null?void 0:i.fish)==null?void 0:t.name)??null;if(!a[f]){const o={seasonStart:null,seasonEnd:null,limits:[]};a[f]=o}return a[f].limits.push(I(i)),a},{});return Object.keys(s).forEach(a=>{s[a].limits=s[a].limits.reduce((t,o)=>{let l=0,x=!1;for(;!x&&l<t.length;)!t[l].waterDescription&&R(o.seasonStart,t[l].seasonStart)&&R(o.seasonEnd,t[l].seasonEnd)&&o.bagLimit===t[l].bagLimit&&o.minimumSize===t[l].minimumSize&&o.maximumSize===t[l].maximumSize&&(x=!0,o.fishingMethod!==t[l].fishingMethod&&(t[l].fishingMethod=""),o.tidal!==t[l].tidal&&(t[l].tidal="")),l++;return x||t.push(o),t},[]),s[a].limits=s[a].limits.sort((t,o)=>{const l=D(t.seasonStart,o.seasonStart);return l===0?o.fishingMethod||o.tidal||o.waterDescription?-1:D(o.seasonEnd,t.seasonEnd):l}),s[a].limits.forEach(t=>{t.bagLimit&&(s[a].seasonStart?F(t.seasonStart,s[a].seasonStart)&&(s[a].seasonStart=t.seasonStart):s[a].seasonStart=t.seasonStart,s[a].seasonEnd&&F(t.seasonEnd,s[a].seasonEnd)||(s[a].seasonEnd=t.seasonEnd))});const i={};let f=0;for(;f<s[a].limits.length;){const t=s[a].limits[f],o=[t.fishingMethod,t.tidal,t.waterDescription].join("-");t.waterDescription&&i[o]?(i[o].group||(i[o].group=[]),i[o].group.push(t),s[a].limits.splice(f,1)):(i[o]=t,f++)}}),s}function ee({children:r,id:s,route:a,...i}){const[f,t]=u.useState([]),[o,l]=u.useState({}),[x,w]=u.useState(!1),z=C();m.useEffect(()=>{z.setLoading(!1)},[]),m.useEffect(()=>{w(!0),axios.get(a(s,"")).then(e=>{t(e.data.limits??[])}).finally(()=>w(!1))},[]),m.useEffect(()=>{l(H(f))},[f]);const[h,_]=u.useState({}),k=e=>{if(console.log(e),e.defaultPrevented)return;const c=e.currentTarget.value;_(d=>{const g=JSON.parse(JSON.stringify(d));return g[c]=!(g!=null&&g[c]),g})},E=e=>(console.log(j(e.seasonStart,S.displayDayMonthShortFormat)),n.jsxs(n.Fragment,{children:[n.jsxs("span",{children:[j(e.seasonStart,S.displayDayMonthShortFormat)," "]}),n.jsxs("span",{children:["-"," ",j(e.seasonEnd,S.displayDayMonthShortFormat)]})]})),y=e=>e.waterDescription?n.jsx("em",{className:"water-description",children:L(e,!1)}):null,L=(e,c=!0)=>{if(c&&e.waterDescription)return"";let d=e.fishingMethod;return e.tidal&&(d&&(d+=" in "),d+=e.tidal),d||(d+=e.water),d+=" "+e.waterDescription,d},N=e=>{const c=(e==null?void 0:e.minSize)??"N/A";return e.bagLimit===0?n.jsx("span",{className:"invalid",children:c}):c},$=e=>{const c=(e==null?void 0:e.maxSize)??"N/A";return e.bagLimit===0?n.jsx("span",{className:"invalid",children:c}):c},B=e=>e.bagLimit===null?n.jsx("span",{className:"text-md leading-4",children:"∞"}):e.bagLimit,b=(e,c=!1)=>n.jsxs("div",{className:`limit ${c?"group":""}`,children:[n.jsxs("div",{className:"season-exception",children:[n.jsx("span",{className:"date-span",children:E(e)}),n.jsxs("em",{className:"exception",children:[" ",L(e)]})]}),n.jsx("div",{children:B(e)}),n.jsx("div",{children:N(e)}),n.jsx("div",{children:$(e)})]}),v=(e,c=!1)=>e.map((d,g)=>d!=null&&d.group?n.jsxs(n.Fragment,{children:[b(d),v(d.group,!0),y(d)]}):n.jsxs(n.Fragment,{children:[b(d,c),c?null:y(d)]}));return n.jsx("div",{className:"Water",children:n.jsxs("div",{className:"fish-grid",children:[n.jsxs("div",{className:"header",children:[n.jsx("div",{className:"column-header date-range",children:"Season/Restrictions"}),n.jsx("div",{className:"column-header",children:"Bag Limit"}),n.jsx("div",{className:"column-header",children:"Min. Size"}),n.jsx("div",{className:"column-header",children:"Max. Size"})]}),n.jsx("div",{className:"body",children:x?n.jsx("div",{className:"loading-spinner-container",children:n.jsx(T,{})}):Object.keys(o??{}).map((e,c)=>n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:k,value:e,className:`fish-name ${c%2===0?"even":"odd"} ${h!=null&&h[e]?"open":""}`,children:[n.jsxs("div",{className:"fish-season",children:[n.jsxs("strong",{children:[n.jsx(O,{className:"open-indicator"}),e]}),n.jsxs("em",{children:["(",E(o[e]),")"]})]}),n.jsx("div",{className:"flex",children:o[e].limits.length>1?n.jsx(W,{message:"Some Restrictions",children:n.jsx(q,{className:"alert"})}):null})]}),n.jsx("div",{className:`limits ${c%2===0?"even":"odd"} ${h!=null&&h[e]?"open":""}`,children:v(o[e].limits)})]}))})]})})}export{ee as default};
