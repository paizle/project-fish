import{r as h,R as _,j as s}from"./app-BDWbdhCy.js";import{useInternalRouting as O}from"./InternalRouter-CNQLmYZn.js";import{t as j,f as x,L as T,c as g}from"./format-CMDDIQXP.js";import{p as c,T as W}from"./Tooltip-ZoLWA57P.js";function E(d,l){const u=+j(d)-+j(l);return u<0?-1:u>0?1:u}function N(d,l){return+j(d)<+j(l)}function B({title:d,titleId:l,...u},p){return h.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:p,"aria-labelledby":l},u),d?h.createElement("title",{id:l},d):null,h.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const C=h.forwardRef(B);function q({children:d,id:l,route:u,...p}){const[b,w]=h.useState([]),[F,S]=h.useState(!1);_.useEffect(()=>{S(!0),axios.get(u(l,"")).then(e=>{w(e.data.limits??[])}).finally(()=>S(!1))},[]);const R=O();_.useEffect(()=>{R.setLoading(!1)},[]);const f=D(b);function D(e){if(!e.length)return;const t=e.reduce((n,a)=>{var o;const r=((o=a==null?void 0:a.fish)==null?void 0:o.name)??null;if(!n[r]){const i={season:null,limits:[]};n[r]=i}return n[r].limits.push(a),n},{});return Object.keys(t).forEach(n=>{t[n].limits=t[n].limits.sort((r,o)=>{const i=E(c(r.season_start),c(o.season_start));return i===0?E(c(r.season_end),c(o.season_end)):i});const a=t[n].limits.reduce((r,o)=>{if(!r.seasonStart)r.seasonStart=c(o.season_start);else{const i=c(o.season_start);N(i,r.seasonStart)&&(r.seasonStart=i)}if(!r.seasonEnd)r.seasonEnd=c(o.season_end);else{const i=c(o.season_end);N(i,r.seasonEnd)||(r.seasonEnd=i)}return r},{seasonStart:null,seasonEnd:null});t[n].season=x(a.seasonStart,g.displayDayMonthShortFormat)+" - "+x(a.seasonEnd,g.displayDayMonthShortFormat)}),t}const[m,L]=h.useState({}),M=e=>{if(console.log(e),e.defaultPrevented){debugger;return}const t=e.currentTarget.value;L(n=>{const a=JSON.parse(JSON.stringify(n));return a[t]=!(a!=null&&a[t]),a})},k=e=>s.jsxs(s.Fragment,{children:[s.jsxs("span",{children:[x(c(e.season_start),g.displayDayMonthShortFormat)," "]}),s.jsxs("span",{children:["-"," ",x(c(e.season_end),g.displayDayMonthShortFormat)]})]}),y=(e,t=!1)=>{let n="";return(t||!e.water_description)&&(e.fishing_method&&(e.fishing_method.name==="May only be angled by artificial fly or baited barbless hook with a single point"?n="Fly Fishing":n=e.fishing_method.name),e.tidal_category&&(n&&(n+=" in "),n+=e.tidal_category.name+" waters")),n},z=e=>{const t=y(e,!0);return e.water_description?s.jsxs("div",{className:"water-description",children:[t?t+" ":e.water.name+" ",e.water_description]}):null},v=e=>e??"N/A",$=e=>e===null?" - ":e;return s.jsx("div",{className:"Water",children:s.jsxs("div",{className:"fish-grid",children:[s.jsxs("div",{className:"header",children:[s.jsx("div",{className:"column-header date-range",children:"Season/Restrictions"}),s.jsx("div",{className:"column-header",children:"Bag Limit"}),s.jsx("div",{className:"column-header",children:"Min. Size"}),s.jsx("div",{className:"column-header",children:"Max. Size"})]}),s.jsx("div",{className:"body",children:F?s.jsx("div",{className:"loading-spinner-container",children:s.jsx(T,{})}):Object.keys(f??{}).map((e,t)=>s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:M,value:e,className:`fish-name ${t%2===0?"even":"odd"} ${m!=null&&m[e]?"open":""}`,children:[s.jsxs("div",{className:"fish-season",children:[s.jsxs("strong",{children:[s.jsx("div",{className:"open-indicator"}),e]}),s.jsxs("em",{children:["(",`${f[e].season}`,")"]})]}),s.jsx("div",{className:"flex",children:f[e].limits.length>1?s.jsx(W,{message:"Some Restrictions",children:s.jsx(C,{className:"alert"})}):null})]}),s.jsx("div",{className:`limits ${t%2===0?"even":"odd"} ${m!=null&&m[e]?"open":""}`,children:f[e].limits.map(n=>s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"season-exception",children:[s.jsx("div",{className:"season-date-span",children:k(n)}),s.jsx("div",{className:"exception",children:y(n)})]}),s.jsx("div",{children:$(n.bag_limit)}),s.jsx("div",{children:v(n.minimum_size)}),s.jsx("div",{children:v(n.maximum_size)}),z(n)]}))})]}))})]})})}export{q as default};
